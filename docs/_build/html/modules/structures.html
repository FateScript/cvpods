

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>cvpods.structures package &mdash; cvpods 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cvpods.utils package" href="utils.html" />
    <link rel="prev" title="cvpods.solver package" href="solver.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> cvpods
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/index.html">Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="checkpoint.html">cvpods.checkpoint package</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">cvpods.configs package</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">cvpods.data package</a></li>
<li class="toctree-l2"><a class="reference internal" href="engine.html">cvpods.engine package</a></li>
<li class="toctree-l2"><a class="reference internal" href="evaluation.html">cvpods.evaluation package</a></li>
<li class="toctree-l2"><a class="reference internal" href="layers.html">cvpods.layers package</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling.html">cvpods.modeling package</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_zoo.html">cvpods.model_zoo package</a></li>
<li class="toctree-l2"><a class="reference internal" href="solver.html">cvpods.solver package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">cvpods.structures package</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">cvpods.utils package</a></li>
<li class="toctree-l2"><a class="reference internal" href="export.html">cvpods.export package</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cvpods</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API Documentation</a> &raquo;</li>
        
      <li>cvpods.structures package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/structures.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-cvpods.structures">
<span id="cvpods-structures-package"></span><h1>cvpods.structures package<a class="headerlink" href="#module-cvpods.structures" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="cvpods.structures.Boxes">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">Boxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This structure stores a list of boxes as a Nx4 torch.Tensor.
It supports some common methods about boxes
(<cite>area</cite>, <cite>clip</cite>, <cite>nonempty</cite>, etc),
and also behaves like a Tensor
(support indexing, <cite>to(device)</cite>, <cite>.device</cite>, and iteration over all boxes)</p>
<dl class="py attribute">
<dt id="cvpods.structures.Boxes.tensor">
<code class="sig-name descname">tensor</code><a class="headerlink" href="#cvpods.structures.Boxes.tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>float matrix of Nx4.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="cvpods.structures.Boxes.BoxSizeType">
<code class="sig-name descname">BoxSizeType</code><em class="property"> = typing.Union[typing.List[int], typing.Tuple[int, int]]</em><a class="headerlink" href="#cvpods.structures.Boxes.BoxSizeType" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor</strong> (<em>Tensor</em><em>[</em><em>float</em><em>]</em>) – a Nx4 matrix.  Each row is (x1, y1, x2, y2).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; cvpods.structures.boxes.Boxes<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone the Boxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Boxes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.boxes.Boxes<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.area">
<code class="sig-name descname">area</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.area" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the area of all the boxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>torch.Tensor</em> – a vector with areas of each box.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.clip">
<code class="sig-name descname">clip</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">box_size</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>int<span class="p">]</span><span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.clip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip (in place) the boxes by limiting x coordinates to the range [0, width]
and y coordinates to the range [0, height].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>box_size</strong> (<em>height</em><em>, </em><em>width</em>) – The clipping box’s size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.nonempty">
<code class="sig-name descname">nonempty</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.nonempty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.nonempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Find boxes that are non-empty.
A box is considered empty, if either of its side is no larger than threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Tensor</em> –     a binary vector which represents whether each box is empty
(False) or non-empty (True).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>slice<span class="p">, </span>torch.BoolTensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.boxes.Boxes<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Boxes</em> – Create a new <a class="reference internal" href="#cvpods.structures.Boxes" title="cvpods.structures.Boxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">Boxes</span></code></a> by indexing.</p>
</dd>
</dl>
<p>The following usage are allowed:</p>
<ol class="arabic simple">
<li><p><cite>new_boxes = boxes[3]</cite>: return a <cite>Boxes</cite> which contains only one box.</p></li>
<li><p><cite>new_boxes = boxes[2:10]</cite>: return a slice of boxes.</p></li>
</ol>
<p>3. <cite>new_boxes = boxes[vector]</cite>, where vector is a torch.BoolTensor
with <cite>length = len(boxes)</cite>. Nonzero elements in the vector will be selected.</p>
<p>Note that the returned Boxes might share storage with this Boxes,
subject to Pytorch’s indexing semantics.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.inside_box">
<code class="sig-name descname">inside_box</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">box_size</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>int<span class="p">]</span><span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">boundary_threshold</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.inside_box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.inside_box" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_size</strong> (<em>height</em><em>, </em><em>width</em>) – Size of the reference box.</p></li>
<li><p><strong>boundary_threshold</strong> (<em>int</em>) – Boxes that extend beyond the reference box
boundary by more than boundary_threshold are considered “outside”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a binary vector, indicating whether each box is inside the reference box.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.get_centers">
<code class="sig-name descname">get_centers</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.get_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.get_centers" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The box centers in a Nx2 array of (x, y).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scale_x</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">scale_y</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the box with horizontal and vertical scaling factors</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.cat">
<em class="property">classmethod </em><code class="sig-name descname">cat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxes_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Boxes<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.boxes.Boxes<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenates a list of Boxes into a single Boxes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes_list</strong> (<em>list</em><em>[</em><a class="reference internal" href="#cvpods.structures.Boxes" title="cvpods.structures.Boxes"><em>Boxes</em></a><em>]</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Boxes</em> – the concatenated Boxes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#cvpods.structures.Boxes.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Boxes.__iter__">
<code class="sig-name descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Iterator<span class="p">[</span>torch.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/cvpods/structures/boxes.html#Boxes.__iter__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Boxes.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield a box as a Tensor of shape (4,) at a time.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cvpods.structures.BoxMode">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">BoxMode</code><a class="reference internal" href="../_modules/cvpods/structures/boxes.html#BoxMode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BoxMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.IntEnum</span></code></p>
<p>Enum of different ways to represent a box.</p>
<dl class="py attribute">
<dt id="cvpods.structures.BoxMode.XYXY_ABS">
<code class="sig-name descname">XYXY_ABS</code><a class="headerlink" href="#cvpods.structures.BoxMode.XYXY_ABS" title="Permalink to this definition">¶</a></dt>
<dd><p>(x0, y0, x1, y1) in absolute floating points coordinates.
The coordinates in range [0, width or height].</p>
</dd></dl>

<dl class="py attribute">
<dt id="cvpods.structures.BoxMode.XYWH_ABS">
<code class="sig-name descname">XYWH_ABS</code><a class="headerlink" href="#cvpods.structures.BoxMode.XYWH_ABS" title="Permalink to this definition">¶</a></dt>
<dd><p>(x0, y0, w, h) in absolute floating points coordinates.</p>
</dd></dl>

<dl class="py attribute">
<dt id="cvpods.structures.BoxMode.XYXY_REL">
<code class="sig-name descname">XYXY_REL</code><a class="headerlink" href="#cvpods.structures.BoxMode.XYXY_REL" title="Permalink to this definition">¶</a></dt>
<dd><p>(x0, y0, x1, y1) in range [0, 1]. They are relative to the size of the image.</p>
</dd></dl>

<dl class="py attribute">
<dt id="cvpods.structures.BoxMode.XYWH_REL">
<code class="sig-name descname">XYWH_REL</code><a class="headerlink" href="#cvpods.structures.BoxMode.XYWH_REL" title="Permalink to this definition">¶</a></dt>
<dd><p>(x0, y0, w, h) in range [0, 1]. They are relative to the size of the image.</p>
</dd></dl>

<dl class="py attribute">
<dt id="cvpods.structures.BoxMode.XYWHA_ABS">
<code class="sig-name descname">XYWHA_ABS</code><a class="headerlink" href="#cvpods.structures.BoxMode.XYWHA_ABS" title="Permalink to this definition">¶</a></dt>
<dd><p>(xc, yc, w, h, a) in absolute floating points coordinates.
(xc, yc) is the center of the rotated box, and the angle a is in degrees ccw.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id0">
<code class="sig-name descname">XYXY_ABS</code><em class="property"> = 0</em><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id1">
<code class="sig-name descname">XYWH_ABS</code><em class="property"> = 1</em><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id2">
<code class="sig-name descname">XYXY_REL</code><em class="property"> = 2</em><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id3">
<code class="sig-name descname">XYWH_REL</code><em class="property"> = 3</em><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id4">
<code class="sig-name descname">XYWHA_ABS</code><em class="property"> = 4</em><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BoxMode.convert">
<em class="property">static </em><code class="sig-name descname">convert</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">box</span><span class="p">:</span> <span class="n">Union[List[float], Tuple[float, …], torch.Tensor, numpy.ndarray]</span></em>, <em class="sig-param"><span class="n">from_mode</span><span class="p">:</span> <span class="n">cvpods.structures.boxes.BoxMode</span></em>, <em class="sig-param"><span class="n">to_mode</span><span class="p">:</span> <span class="n">cvpods.structures.boxes.BoxMode</span></em><span class="sig-paren">)</span> &#x2192; Union[List[float], Tuple[float, …], torch.Tensor, numpy.ndarray]<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#BoxMode.convert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BoxMode.convert" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> – can be a k-tuple, k-list or an Nxk array/tensor, where k = 4 or 5</p></li>
<li><p><strong>to_mode</strong> (<em>from_mode</em><em>,</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The converted box of the same type.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="cvpods.structures.pairwise_ioa">
<code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">pairwise_ioa</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gt</span><span class="p">:</span> <span class="n">cvpods.structures.boxes.Boxes</span></em>, <em class="sig-param"><span class="n">boxes</span><span class="p">:</span> <span class="n">cvpods.structures.boxes.Boxes</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">ignore_label</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#pairwise_ioa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.pairwise_ioa" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two lists of boxes of size N and M,
compute the IoU (intersection over union)
between __all__ N x M pairs of boxes.
The box order must be (xmin, ymin, xmax, ymax).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes1</strong><strong>,</strong><strong>boxes2</strong> (<a class="reference internal" href="#cvpods.structures.Boxes" title="cvpods.structures.Boxes"><em>Boxes</em></a>) – two <cite>Boxes</cite>. Contains N &amp; M boxes, respectively.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Tensor</em> – IoU, sized [N,M].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cvpods.structures.pairwise_iou">
<code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">pairwise_iou</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxes1</span><span class="p">:</span> <span class="n">cvpods.structures.boxes.Boxes</span></em>, <em class="sig-param"><span class="n">boxes2</span><span class="p">:</span> <span class="n">cvpods.structures.boxes.Boxes</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/boxes.html#pairwise_iou"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.pairwise_iou" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two lists of boxes of size N and M,
compute the IoU (intersection over union)
between __all__ N x M pairs of boxes.
The box order must be (xmin, ymin, xmax, ymax).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes1</strong><strong>,</strong><strong>boxes2</strong> (<a class="reference internal" href="#cvpods.structures.Boxes" title="cvpods.structures.Boxes"><em>Boxes</em></a>) – two <cite>Boxes</cite>. Contains N &amp; M boxes, respectively.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Tensor</em> – IoU, sized [N,M].</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="cvpods.structures.ImageList">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">ImageList</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">image_sizes</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/image_list.html#ImageList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.ImageList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Structure that holds a list of images (of possibly
varying sizes) as a single tensor.
This works by padding the images to the same size,
and storing in a field the original sizes of each image</p>
<dl class="py attribute">
<dt id="cvpods.structures.ImageList.image_sizes">
<code class="sig-name descname">image_sizes</code><a class="headerlink" href="#cvpods.structures.ImageList.image_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>each tuple is (h, w)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list[tuple[int, int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.ImageList.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">image_sizes</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/image_list.html#ImageList.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.ImageList.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>Tensor</em>) – of shape (N, H, W) or (N, C_1, …, C_K, H, W) where K &gt;= 1</p></li>
<li><p><strong>image_sizes</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – Each tuple is (h, w).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.ImageList.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>slice<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/image_list.html#ImageList.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.ImageList.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Access the individual image in its original size.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Tensor</em> – an image of shape (H, W) or (C_1, …, C_K, H, W) where K &gt;= 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.ImageList.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.image_list.ImageList<a class="reference internal" href="../_modules/cvpods/structures/image_list.html#ImageList.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.ImageList.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.ImageList.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#cvpods.structures.ImageList.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.ImageList.from_tensors">
<em class="property">static </em><code class="sig-name descname">from_tensors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensors</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">size_divisibility</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">pad_ref_long</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pad_value</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.image_list.ImageList<a class="reference internal" href="../_modules/cvpods/structures/image_list.html#ImageList.from_tensors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.ImageList.from_tensors" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensors</strong> – a tuple or list of <cite>torch.Tensors</cite>, each of shape (Hi, Wi) or
(C_1, …, C_K, Hi, Wi) where K &gt;= 1. The Tensors will be padded with <cite>pad_value</cite>
so that they will have the same shape.</p></li>
<li><p><strong>size_divisibility</strong> (<em>int</em>) – If <cite>size_divisibility &gt; 0</cite>, also adds padding to ensure
the common height and width is divisible by <cite>size_divisibility</cite></p></li>
<li><p><strong>pad_value</strong> (<em>float</em>) – value to pad</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an <cite>ImageList</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cvpods.structures.Instances">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">Instances</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_size</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class represents a list of instances in an image.
It stores the attributes of instances (e.g., boxes, masks, labels, scores) as “fields”.
All fields must have the same <code class="docutils literal notranslate"><span class="pre">__len__</span></code> which is the number of instances.</p>
<p>All other (non-field) attributes of this class are considered private:
they must start with ‘_’ and are not modifiable by a user.</p>
<p>Some basic usage:</p>
<ol class="arabic">
<li><p>Set/Get a field:
.. code-block:: python</p>
<blockquote>
<div><p>instances.gt_boxes = Boxes(…)
print(instances.pred_masks)  # a tensor of shape (N, H, W)
print(‘gt_masks’ in instances)</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">len(instances)</span></code> returns the number of instances</p></li>
<li><p>Indexing: <code class="docutils literal notranslate"><span class="pre">instances[indices]</span></code> will apply the indexing on all the fields
and returns a new <a class="reference internal" href="#cvpods.structures.Instances" title="cvpods.structures.Instances"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instances</span></code></a>.
Typically, <code class="docutils literal notranslate"><span class="pre">indices</span></code> is a integer vector of indices,
or a binary mask of length <code class="docutils literal notranslate"><span class="pre">num_instances</span></code>,</p></li>
</ol>
<dl class="py method">
<dt id="cvpods.structures.Instances.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_size</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_size</strong> (<em>height</em><em>, </em><em>width</em>) – the spatial size of the image.</p></li>
<li><p><strong>kwargs</strong> – fields to add to this <cite>Instances</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.image_size">
<em class="property">property </em><code class="sig-name descname">image_size</code><a class="headerlink" href="#cvpods.structures.Instances.image_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns:
tuple: height, width</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.set">
<code class="sig-name descname">set</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">value</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the field named <cite>name</cite> to <cite>value</cite>.
The length of <cite>value</cite> must be the number of instances,
and must agree with other existing fields in this object.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.has">
<code class="sig-name descname">has</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.has"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.has" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>bool</em> – whether the field called <cite>name</cite> exists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.remove">
<code class="sig-name descname">remove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the field called <cite>name</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Any<a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the field called <cite>name</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.get_fields">
<code class="sig-name descname">get_fields</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>Any<span class="p">]</span><a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.get_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.get_fields" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>dict</em> – a dict which maps names (str) to data of the fields</p>
</dd>
</dl>
<p>Modifying the returned dict will modify this instance.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.instances.Instances<a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.to" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Instances</em> – all fields are called with a <cite>to(device)</cite>, if the field has this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>slice<span class="p">, </span>torch.BoolTensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.instances.Instances<a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> – an index-like object and will be used to index all the fields.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>item</cite> is a string, return the data in the corresponding field.
Otherwise, returns an <cite>Instances</cite> where all fields are indexed by <cite>item</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Instances.cat">
<em class="property">static </em><code class="sig-name descname">cat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">instance_lists</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Instances<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.instances.Instances<a class="reference internal" href="../_modules/cvpods/structures/instances.html#Instances.cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Instances.cat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>instance_lists</strong> (<em>list</em><em>[</em><a class="reference internal" href="#cvpods.structures.Instances" title="cvpods.structures.Instances"><em>Instances</em></a><em>]</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Instances</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cvpods.structures.Keypoints">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">Keypoints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">keypoints</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">, </span>List<span class="p">[</span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/keypoints.html#Keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Keypoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stores keypoint annotation data. GT Instances have a <cite>gt_keypoints</cite> property
containing the x,y location and visibility flag of each keypoint. This tensor has shape
(N, K, 3) where N is the number of instances and K is the number of keypoints per instance.</p>
<p>The visibility flag follows the COCO format and must be one of three integers:
* v=0: not labeled (in which case x=y=0)
* v=1: labeled but not visible
* v=2: labeled and visible</p>
<dl class="py method">
<dt id="cvpods.structures.Keypoints.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">keypoints</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">, </span>List<span class="p">[</span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/keypoints.html#Keypoints.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Keypoints.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keypoints</strong> – A Tensor, numpy array, or list of the x, y, and visibility of each keypoint.</p></li>
<li><p><strong>shape should be</strong> (<em>The</em>) – </p></li>
<li><p><strong>and K is the number of keypoints per instance.</strong> (<em>instances</em><em>,</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Keypoints.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.keypoints.Keypoints<a class="reference internal" href="../_modules/cvpods/structures/keypoints.html#Keypoints.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Keypoints.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Keypoints.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#cvpods.structures.Keypoints.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Keypoints.to_heatmap">
<code class="sig-name descname">to_heatmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxes</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">heatmap_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/keypoints.html#Keypoints.to_heatmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Keypoints.to_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes</strong> – Nx4 tensor, the boxes to draw the keypoints to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><em>heatmaps</em> –     A tensor of shape (N, K) containing an integer spatial label</dt><dd><p>in the range [0, heatmap_size**2 - 1] for each keypoint in the input.</p>
</dd>
<dt>valid:</dt><dd><p>A tensor of shape (N, K) containing whether each keypoint is in the roi or not.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.Keypoints.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>slice<span class="p">, </span>torch.BoolTensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.keypoints.Keypoints<a class="reference internal" href="../_modules/cvpods/structures/keypoints.html#Keypoints.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.Keypoints.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new <cite>Keypoints</cite> by indexing on this <cite>Keypoints</cite>.</p>
<p>The following usage are allowed:</p>
<ol class="arabic simple">
<li><p><cite>new_kpts = kpts[3]</cite>: return a <cite>Keypoints</cite> which contains only one instance.</p></li>
<li><p><cite>new_kpts = kpts[2:10]</cite>: return a slice of key points.</p></li>
<li><p><cite>new_kpts = kpts[vector]</cite>, where vector is a torch.ByteTensor
with <cite>length = len(kpts)</cite>. Nonzero elements in the vector will be selected.</p></li>
</ol>
<p>Note that the returned Keypoints might share storage with this Keypoints,
subject to Pytorch’s indexing semantics.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="cvpods.structures.heatmaps_to_keypoints">
<code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">heatmaps_to_keypoints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maps</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">rois</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/keypoints.html#heatmaps_to_keypoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.heatmaps_to_keypoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract predicted keypoint locations from heatmaps.
:param maps: (#ROIs, #keypoints, POOL_H, POOL_W). The predicted heatmap of logits for
:type maps: Tensor
:param each ROI and each keypoint.:
:param rois: (#ROIs, 4). The box of each ROI.
:type rois: Tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor of shape (#ROIs, #keypoints, 4) with the last dimension corresponding to
(x, y, logit, score) for each keypoint.</p>
</dd>
</dl>
<p>When converting discrete pixel indices in an NxN image to a continuous keypoint coordinate,
we maintain consistency with <a class="reference internal" href="#cvpods.structures.Keypoints.to_heatmap" title="cvpods.structures.Keypoints.to_heatmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Keypoints.to_heatmap()</span></code></a> by using the conversion from
Heckbert 1990: c = d + 0.5, where d is a discrete coordinate and c is a continuous coordinate.</p>
</dd></dl>

<dl class="py class">
<dt id="cvpods.structures.BitMasks">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">BitMasks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class stores the segmentation masks for all objects in one image, in
the form of bitmaps.</p>
<dl class="py attribute">
<dt id="cvpods.structures.BitMasks.tensor">
<code class="sig-name descname">tensor</code><a class="headerlink" href="#cvpods.structures.BitMasks.tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>bool Tensor of N,H,W, representing N instances in the image.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor</strong> – bool Tensor of N,H,W, representing N instances in the image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.masks.BitMasks<a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#cvpods.structures.BitMasks.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>slice<span class="p">, </span>torch.BoolTensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.masks.BitMasks<a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>BitMasks</em> – Create a new <a class="reference internal" href="#cvpods.structures.BitMasks" title="cvpods.structures.BitMasks"><code class="xref py py-class docutils literal notranslate"><span class="pre">BitMasks</span></code></a> by indexing.</p>
</dd>
</dl>
<p>The following usage are allowed:</p>
<ol class="arabic simple">
<li><p><cite>new_masks = masks[3]</cite>: return a <cite>BitMasks</cite> which contains only one mask.</p></li>
<li><p><cite>new_masks = masks[2:10]</cite>: return a slice of masks.</p></li>
<li><p><cite>new_masks = masks[vector]</cite>, where vector is a torch.BoolTensor
with <cite>length = len(masks)</cite>. Nonzero elements in the vector will be selected.</p></li>
</ol>
<p>Note that the returned object might share storage with this object,
subject to Pytorch’s indexing semantics.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.nonempty">
<code class="sig-name descname">nonempty</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.nonempty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.nonempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Find masks that are non-empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><em>Tensor</em> –</p>
<dl class="simple">
<dt>a BoolTensor which represents</dt><dd><p>whether each mask is empty (False) or non-empty (True).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.from_polygon_masks">
<em class="property">static </em><code class="sig-name descname">from_polygon_masks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">polygon_masks</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>PolygonMasks<span class="p">, </span>List<span class="p">[</span>List<span class="p">[</span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">width</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.masks.BitMasks<a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.from_polygon_masks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.from_polygon_masks" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygon_masks</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>ndarray</em><em>]</em><em>] or </em><a class="reference internal" href="#cvpods.structures.PolygonMasks" title="cvpods.structures.PolygonMasks"><em>PolygonMasks</em></a>) – </p></li>
<li><p><strong>width</strong> (<em>height</em><em>,</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.crop_and_resize">
<code class="sig-name descname">crop_and_resize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxes</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">mask_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.crop_and_resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.crop_and_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop each bitmask by the given box, and resize results to (mask_size, mask_size).
This can be used to prepare training targets for Mask R-CNN.
It has less reconstruction error compared to rasterization with polygons.
However we observe no difference in accuracy,
but BitMasks requires more memory to store all the masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boxes</strong> (<em>Tensor</em>) – Nx4 tensor storing the boxes for each mask</p></li>
<li><p><strong>mask_size</strong> (<em>int</em>) – the size of the rasterized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Tensor</em> –     A bool tensor of shape (N, mask_size, mask_size), where
N is the number of predicted boxes for this image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.get_bounding_boxes">
<code class="sig-name descname">get_bounding_boxes</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.get_bounding_boxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.get_bounding_boxes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Boxes</em> – tight bounding boxes around bit masks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.BitMasks.cat">
<em class="property">static </em><code class="sig-name descname">cat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bitmasks_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>BitMasks<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.masks.BitMasks<a class="reference internal" href="../_modules/cvpods/structures/masks.html#BitMasks.cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.BitMasks.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenates a list of BitMasks into a single BitMasks
:param bitmasks_list:
:type bitmasks_list: list[BitMasks]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>BitMasks</em> – the concatenated BitMasks</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="cvpods.structures.PolygonMasks">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">PolygonMasks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">polygons</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class stores the segmentation masks for all objects in one image, in the form of polygons.</p>
<dl class="py attribute">
<dt id="cvpods.structures.PolygonMasks.polygons">
<code class="sig-name descname">polygons</code><a class="headerlink" href="#cvpods.structures.PolygonMasks.polygons" title="Permalink to this definition">¶</a></dt>
<dd><p>list[list[ndarray]]. Each ndarray is a float64 vector representing a polygon.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">polygons</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>polygons</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>Tensor</em><em>[</em><em>float</em><em>]</em><em>]</em><em>]</em>) – The first
level of the list correspond to individual instances,
the second level to all the polygons that compose the
instance, and the third level to the polygon coordinates.
The third level Tensor should have the format of
torch.Tensor([x0, y0, x1, y1, …, xn, yn]) (n &gt;= 3).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.masks.PolygonMasks<a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#cvpods.structures.PolygonMasks.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.get_bounding_boxes">
<code class="sig-name descname">get_bounding_boxes</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; cvpods.structures.boxes.Boxes<a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.get_bounding_boxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.get_bounding_boxes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Boxes</em> – tight bounding boxes around polygon masks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.nonempty">
<code class="sig-name descname">nonempty</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.nonempty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.nonempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Find masks that are non-empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Tensor</em> –     a BoolTensor which represents whether each mask is empty (False) or not (True).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>slice<span class="p">, </span>List<span class="p">[</span>int<span class="p">]</span><span class="p">, </span>torch.BoolTensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.masks.PolygonMasks<a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Support indexing over the instances and return a <cite>PolygonMasks</cite> object.
<cite>item</cite> can be:</p>
<ol class="arabic simple">
<li><p>An integer. It will return an object with only one instance.</p></li>
<li><p>A slice. It will return an object with the selected instances.</p></li>
<li><p>A list[int]. It will return an object with the selected instances,
correpsonding to the indices in the list.</p></li>
<li><p>A vector mask of type BoolTensor, whose length is num_instances.
It will return an object with the instances whose mask is nonzero.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.__iter__">
<code class="sig-name descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Iterator<span class="p">[</span>List<span class="p">[</span>torch.Tensor<span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.__iter__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p><em>list[ndarray]</em> – the polygons for one instance.
Each Tensor is a float64 vector representing a polygon.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.crop_and_resize">
<code class="sig-name descname">crop_and_resize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxes</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">mask_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.crop_and_resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.crop_and_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop each mask by the given box, and resize results to (mask_size, mask_size).
This can be used to prepare training targets for Mask R-CNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boxes</strong> (<em>Tensor</em>) – Nx4 tensor storing the boxes for each mask</p></li>
<li><p><strong>mask_size</strong> (<em>int</em>) – the size of the rasterized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Tensor</em> – A bool tensor of shape (N, mask_size, mask_size), where
N is the number of predicted boxes for this image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.area">
<code class="sig-name descname">area</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.area" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes area of the mask.
Only works with Polygons, using the shoelace formula:
<a class="reference external" href="https://stackoverflow.com/questions/24467972/calculate-area-of-polygon-given-x-y-coordinates">https://stackoverflow.com/questions/24467972/calculate-area-of-polygon-given-x-y-coordinates</a>
:returns: <em>Tensor</em> – a vector, area for each instance</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.PolygonMasks.cat">
<em class="property">static </em><code class="sig-name descname">cat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">polymasks_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>PolygonMasks<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.masks.PolygonMasks<a class="reference internal" href="../_modules/cvpods/structures/masks.html#PolygonMasks.cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.PolygonMasks.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenates a list of PolygonMasks into a single PolygonMasks
:param polymasks_list:
:type polymasks_list: list[PolygonMasks]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>PolygonMasks</em> – the concatenated PolygonMasks</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="cvpods.structures.polygons_to_bitmask">
<code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">polygons_to_bitmask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">polygons</span><span class="p">:</span> <span class="n">List<span class="p">[</span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">width</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/cvpods/structures/masks.html#polygons_to_bitmask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.polygons_to_bitmask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygons</strong> (<em>list</em><em>[</em><em>ndarray</em><em>]</em>) – each array has shape (Nx2,)</p></li>
<li><p><strong>width</strong> (<em>height</em><em>,</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – a bool mask of shape (height, width)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="cvpods.structures.rasterize_polygons_within_box">
<code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">rasterize_polygons_within_box</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">polygons</span><span class="p">:</span> <span class="n">List<span class="p">[</span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">box</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">mask_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/masks.html#rasterize_polygons_within_box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.rasterize_polygons_within_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Rasterize the polygons into a mask image and
crop the mask content in the given box.
The cropped mask is resized to (mask_size, mask_size).</p>
<p>This function is used when generating training targets for mask head in Mask R-CNN.
Given original ground-truth masks for an image, new ground-truth mask
training targets in the size of <cite>mask_size x mask_size</cite>
must be provided for each predicted box. This function will be called to
produce such targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygons</strong> (<em>list</em><em>[</em><em>ndarray</em><em>[</em><em>float</em><em>]</em><em>]</em>) – a list of polygons, which represents an instance.</p></li>
<li><p><strong>box</strong> – 4-element numpy array</p></li>
<li><p><strong>mask_size</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Tensor</em> – BoolTensor of shape (mask_size, mask_size)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="cvpods.structures.RotatedBoxes">
<em class="property">class </em><code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">RotatedBoxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">cvpods.structures.boxes.Boxes</span></code></p>
<p>This structure stores a list of rotated boxes as a Nx5 torch.Tensor.
It supports some common methods about boxes
(<cite>area</cite>, <cite>clip</cite>, <cite>nonempty</cite>, etc),
and also behaves like a Tensor
(support indexing, <cite>to(device)</cite>, <cite>.device</cite>, and iteration over all boxes)</p>
<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor</strong> (<em>Tensor</em><em>[</em><em>float</em><em>]</em>) – a Nx5 matrix.  Each row is
(x_center, y_center, width, height, angle),
in which angle is represented in degrees.
While there’s no strict range restriction for it,
the recommended principal range is between [-180, 180) degrees.</p>
</dd>
</dl>
<p>Assume we have a horizontal box B = (x_center, y_center, width, height),
where width is along the x-axis and height is along the y-axis.
The rotated box B_rot (x_center, y_center, width, height, angle)
can be seen as:</p>
<ol class="arabic simple">
<li><p>When angle == 0:
B_rot == B</p></li>
<li><p>When angle &gt; 0:
B_rot is obtained by rotating B w.r.t its center by <span class="math notranslate nohighlight">\(|angle|\)</span> degrees CCW;</p></li>
<li><p>When angle &lt; 0:
B_rot is obtained by rotating B w.r.t its center by <span class="math notranslate nohighlight">\(|angle|\)</span> degrees CW.</p></li>
</ol>
<p>Mathematically, since the right-handed coordinate system for image space
is (y, x), where y is top-&gt;down and x is left-&gt;right, the 4 vertices of the
rotated rectangle <span class="math notranslate nohighlight">\((yr_i, xr_i)\)</span> (i = 1, 2, 3, 4) can be obtained from
the vertices of the horizontal rectangle (y_i, x_i) (i = 1, 2, 3, 4)
in the following way (<span class="math notranslate nohighlight">\(\theta = angle*\pi/180\)</span> is the angle in radians,
(y_c, x_c) is the center of the rectangle):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}yr_i = \cos(\theta) (y_i - y_c) - \sin(\theta) (x_i - x_c) + y_c,\\xr_i = \sin(\theta) (y_i - y_c) + \cos(\theta) (x_i - x_c) + x_c,\end{aligned}\end{align} \]</div>
<p>which is the standard rigid-body rotation transformation.</p>
<p>Intuitively, the angle is
(1) the rotation angle from y-axis in image space
to the height vector (top-&gt;down in the box’s local coordinate system)
of the box in CCW, and
(2) the rotation angle from x-axis in image space
to the width vector (left-&gt;right in the box’s local coordinate system)
of the box in CCW.</p>
<p>More intuitively, consider the following horizontal box ABCD represented
in (x1, y1, x2, y2): (3, 2, 7, 4),
covering the [3, 7] x [2, 4] region of the continuous coordinate system
which looks like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>O--------&gt; x
|
|  A---B
|  |   |
|  D---C
|
v y
</pre></div>
</div>
<p>Note that each capital letter represents one 0-dimensional geometric point
instead of a ‘square pixel’ here.</p>
<p>In the example above, using (x, y) to represent a point we have:</p>
<div class="math notranslate nohighlight">
\[O = (0, 0), A = (3, 2), B = (7, 2), C = (7, 4), D = (3, 4)\]</div>
<p>We name vector AB = vector DC as the width vector in box’s local coordinate system, and
vector AD = vector BC as the height vector in box’s local coordinate system. Initially,
when angle = 0 degree, they’re aligned with the positive directions of x-axis and y-axis
in the image space, respectively.</p>
<p>For better illustration, we denote the center of the box as E,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>O--------&gt; x
|
|  A---B
|  | E |
|  D---C
|
v y
</pre></div>
</div>
<p>where the center E = ((3+7)/2, (2+4)/2) = (5, 3).</p>
<p>Also,</p>
<div class="math notranslate nohighlight">
\[width = |AB| = |CD| = 7 - 3 = 4,
height = |AD| = |BC| = 4 - 2 = 2.\]</div>
<p>Therefore, the corresponding representation for the same shape in rotated box in
(x_center, y_center, width, height, angle) format is:</p>
<p>(5, 3, 4, 2, 0),</p>
<p>Now, let’s consider (5, 3, 4, 2, 90), which is rotated by 90 degrees
CCW (counter-clockwise) by definition. It looks like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>O--------&gt; x
|   B-C
|   | |
|   |E|
|   | |
|   A-D
v y
</pre></div>
</div>
<p>The center E is still located at the same point (5, 3), while the vertices
ABCD are rotated by 90 degrees CCW with regard to E:
A = (4, 5), B = (4, 1), C = (6, 1), D = (6, 5)</p>
<p>Here, 90 degrees can be seen as the CCW angle to rotate from y-axis to
vector AD or vector BC (the top-&gt;down height vector in box’s local coordinate system),
or the CCW angle to rotate from x-axis to vector AB or vector DC (the left-&gt;right
width vector in box’s local coordinate system).</p>
<div class="math notranslate nohighlight">
\[width = |AB| = |CD| = 5 - 1 = 4,
height = |AD| = |BC| = 6 - 4 = 2.\]</div>
<p>Next, how about (5, 3, 4, 2, -90), which is rotated by 90 degrees CW (clockwise)
by definition? It looks like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>O--------&gt; x
|   D-A
|   | |
|   |E|
|   | |
|   C-B
v y
</pre></div>
</div>
<p>The center E is still located at the same point (5, 3), while the vertices
ABCD are rotated by 90 degrees CW with regard to E:
A = (6, 1), B = (6, 5), C = (4, 5), D = (4, 1)</p>
<div class="math notranslate nohighlight">
\[width = |AB| = |CD| = 5 - 1 = 4,
height = |AD| = |BC| = 6 - 4 = 2.\]</div>
<p>This covers exactly the same region as (5, 3, 4, 2, 90) does, and their IoU
will be 1. However, these two will generate different RoI Pooling results and
should not be treated as an identical box.</p>
<p>On the other hand, it’s easy to see that (X, Y, W, H, A) is identical to
(X, Y, W, H, A+360N), for any integer N. For example (5, 3, 4, 2, 270) would be
identical to (5, 3, 4, 2, -90), because rotating the shape 270 degrees CCW is
equivalent to rotating the same shape 90 degrees CW.</p>
<p>We could rotate further to get (5, 3, 4, 2, 180), or (5, 3, 4, 2, -180):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>O--------&gt; x
|
|  C---D
|  | E |
|  B---A
|
v y
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}A = (7, 4), B = (3, 4), C = (3, 2), D = (7, 2),\\width = |AB| = |CD| = 7 - 3 = 4,
height = |AD| = |BC| = 4 - 2 = 2.\end{aligned}\end{align} \]</div>
<p>Finally, this is a very inaccurate (heavily quantized) illustration of
how (5, 3, 4, 2, 60) looks like in case anyone wonders:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>O--------&gt; x
|     B            |    /  C
|   /E /
|  A  /
|   `D
v y
</pre></div>
</div>
<p>It’s still a rectangle with center of (5, 3), width of 4 and height of 2,
but its angle (and thus orientation) is somewhere between
(5, 3, 4, 2, 0) and (5, 3, 4, 2, 90).</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; cvpods.structures.rotated_boxes.RotatedBoxes<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone the RotatedBoxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>RotatedBoxes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">device</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.rotated_boxes.RotatedBoxes<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.area">
<code class="sig-name descname">area</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.area" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the area of all the boxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>torch.Tensor</em> – a vector with areas of each box.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.normalize_angles">
<code class="sig-name descname">normalize_angles</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.normalize_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.normalize_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Restrict angles to the range of [-180, 180) degrees</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.clip">
<code class="sig-name descname">clip</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">box_size</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>int<span class="p">]</span><span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">clip_angle_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.clip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip (in place) the boxes by limiting x coordinates to the range [0, width]
and y coordinates to the range [0, height].</p>
<p>For RRPN:
Only clip boxes that are almost horizontal with a tolerance of
clip_angle_threshold to maintain backward compatibility.</p>
<p>Rotated boxes beyond this threshold are not clipped for two reasons:</p>
<ol class="arabic simple">
<li><p>There are potentially multiple ways to clip a rotated box to make it
fit within the image.</p></li>
<li><p>It’s tricky to make the entire rectangular box fit within the image
and still be able to not leave out pixels of interest.</p></li>
</ol>
<p>Therefore we rely on ops like RoIAlignRotated to safely handle this.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_size</strong> (<em>height</em><em>, </em><em>width</em>) – The clipping box’s size.</p></li>
<li><p><strong>clip_angle_threshold</strong> – Iff. abs(normalized(angle)) &lt;= clip_angle_threshold (in degrees),
we do the clipping as horizontal boxes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.nonempty">
<code class="sig-name descname">nonempty</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.nonempty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.nonempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Find boxes that are non-empty.
A box is considered empty, if either of its side is no larger than threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Tensor</em> – a binary vector which represents
whether each box is empty (False) or non-empty (True).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>slice<span class="p">, </span>torch.BoolTensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.rotated_boxes.RotatedBoxes<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>RotatedBoxes</em> – Create a new <a class="reference internal" href="#cvpods.structures.RotatedBoxes" title="cvpods.structures.RotatedBoxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">RotatedBoxes</span></code></a> by indexing.</p>
</dd>
</dl>
<p>The following usage are allowed:</p>
<ol class="arabic simple">
<li><p><cite>new_boxes = boxes[3]</cite>: return a <cite>RotatedBoxes</cite> which contains only one box.</p></li>
<li><p><cite>new_boxes = boxes[2:10]</cite>: return a slice of boxes.</p></li>
<li><p><cite>new_boxes = boxes[vector]</cite>, where vector is a torch.ByteTensor
with <cite>length = len(boxes)</cite>. Nonzero elements in the vector will be selected.</p></li>
</ol>
<p>Note that the returned RotatedBoxes might share storage with this RotatedBoxes,
subject to Pytorch’s indexing semantics.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.inside_box">
<code class="sig-name descname">inside_box</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">box_size</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>int<span class="p">]</span><span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">boundary_threshold</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.inside_box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.inside_box" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_size</strong> (<em>height</em><em>, </em><em>width</em>) – Size of the reference box covering
[0, width] x [0, height]</p></li>
<li><p><strong>boundary_threshold</strong> (<em>int</em>) – Boxes that extend beyond the reference box
boundary by more than boundary_threshold are considered “outside”.</p></li>
</ul>
</dd>
</dl>
<p>For RRPN, it might not be necessary to call this function since it’s common
for rotated box to extend to outside of the image boundaries
(the clip function only clips the near-horizontal boxes)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a binary vector, indicating whether each box is inside the reference box.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.get_centers">
<code class="sig-name descname">get_centers</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.get_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.get_centers" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The box centers in a Nx2 array of (x, y).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scale_x</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">scale_y</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the rotated box with horizontal and vertical scaling factors
Note: when scale_factor_x != scale_factor_y,
the rotated box does not preserve the rectangular shape when the angle
is not a multiple of 90 degrees under resize transformation.
Instead, the shape is a parallelogram (that has skew)
Here we make an approximation by fitting a rotated rectangle to the parallelogram.</p>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.cat">
<em class="property">classmethod </em><code class="sig-name descname">cat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxes_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>RotatedBoxes<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; cvpods.structures.rotated_boxes.RotatedBoxes<a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.cat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenates a list of RotatedBoxes into a single RotatedBoxes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes_list</strong> (<em>list</em><em>[</em><a class="reference internal" href="#cvpods.structures.RotatedBoxes" title="cvpods.structures.RotatedBoxes"><em>RotatedBoxes</em></a><em>]</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>RotatedBoxes</em> – the concatenated RotatedBoxes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#cvpods.structures.RotatedBoxes.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="cvpods.structures.RotatedBoxes.__iter__">
<code class="sig-name descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Iterator<span class="p">[</span>torch.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/cvpods/structures/rotated_boxes.html#RotatedBoxes.__iter__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cvpods.structures.RotatedBoxes.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield a box as a Tensor of shape (5,) at a time.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="cvpods.structures.pairwise_iou_rotated">
<code class="sig-prename descclassname">cvpods.structures.</code><code class="sig-name descname">pairwise_iou_rotated</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">boxes1</span><span class="p">:</span> <span class="n">cvpods.structures.rotated_boxes.RotatedBoxes</span></em>, <em class="sig-param"><span class="n">boxes2</span><span class="p">:</span> <span class="n">cvpods.structures.rotated_boxes.RotatedBoxes</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cvpods.structures.pairwise_iou_rotated" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two lists of rotated boxes of size N and M,
compute the IoU (intersection over union)
between __all__ N x M pairs of boxes.
The box order must be (x_center, y_center, width, height, angle).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boxes2</strong> (<em>boxes1</em><em>,</em>) – two <cite>RotatedBoxes</cite>. Contains N &amp; M rotated boxes, respectively.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Tensor</em> – IoU, sized [N,M].</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="utils.html" class="btn btn-neutral float-right" title="cvpods.utils package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="solver.html" class="btn btn-neutral float-left" title="cvpods.solver package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, cvpods contributors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>